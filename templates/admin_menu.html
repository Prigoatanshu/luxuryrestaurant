{% extends "base.html" %}
{% block content %}

<div class="container my-5">
  <div class="d-flex flex-wrap align-items-center justify-content-between mb-4">
    <div>
      <div class="section-title">Admin</div>
      <h2 class="mt-2 mb-0">Menu Manager</h2>
    </div>
    <a class="btn btn-outline-wine" href="/admin/logout">Logout</a>
  </div>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <div class="alert alert-dark" role="alert">
        {{ messages[0] }}
      </div>
    {% endif %}
  {% endwith %}

  <div class="story-card mb-4">
    <h4 class="mb-3">Add New Item</h4>
    <form method="POST" class="row g-3">
      <input type="hidden" name="action" value="add">
      <div class="col-md-3">
        <select class="form-select" name="category" required>
          {% for category in categories %}
            <option value="{{ category }}">{{ category }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-3">
        <input class="form-control" name="name" placeholder="Name" required>
      </div>
      <div class="col-md-3">
        <input class="form-control" name="price" placeholder="$24" required>
      </div>
      <div class="col-md-12">
        <input class="form-control" name="description" placeholder="Description" required>
      </div>
      <div class="col-md-12">
        <input class="form-control" name="image_url" placeholder="Image URL" required>
      </div>
      <div class="col-md-12">
        <button class="btn btn-danger">Add Item</button>
      </div>
    </form>
  </div>

  <div class="story-card">
    <h4 class="mb-3">Edit Existing Items</h4>
    {% for item in items %}
      <form method="POST" class="row g-3 align-items-end border-bottom pb-3 mb-3">
        <input type="hidden" name="id" value="{{ item['id'] }}">
        <div class="col-md-2">
          <label class="form-label">Category</label>
          <select class="form-select" name="category" required>
            {% for category in categories %}
              <option value="{{ category }}" {% if category == item['category'] %}selected{% endif %}>
                {{ category }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-2">
          <label class="form-label">Name</label>
          <input class="form-control" name="name" value="{{ item['name'] }}" required>
        </div>
        <div class="col-md-2">
          <label class="form-label">Price</label>
          <input class="form-control" name="price" value="{{ item['price'] }}" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Description</label>
          <input class="form-control" name="description" value="{{ item['description'] }}" required>
        </div>
        <div class="col-md-3">
          <label class="form-label">Image URL</label>
          <input class="form-control" name="image_url" value="{{ item['image_url'] }}" required>
        </div>
        <div class="col-md-12 d-flex gap-2">
          <button class="btn btn-dark" name="action" value="update">Update</button>
          <button class="btn btn-outline-wine" name="action" value="delete">Delete</button>
        </div>
      </form>
    {% endfor %}
  </div>
</div>

{% endblock %}
